<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <template id="address" name="Configure eCommerce Address Fields" inherit_id="website_sale.address">

        <xpath expr="//div[@id='div_phone']" position="attributes">
            <attribute name="t-if">
                mode[1] == 'billing' and website.use_billing_address_phone or \
                mode[1] == 'shipping' and website.use_shipping_address_phone or \
                partner_id == website_sale_order.partner_shipping_id.id == website_sale_order.partner_invoice_id.id and website.use_shipping_address_phone
            </attribute>
        </xpath>
        <xpath expr="//input[@name='field_required']" position="replace">
            <input t-if="website.use_billing_address_phone" type="hidden" name="field_required" t-att-value="'phone,name'" />
            <input t-else="" type="hidden" name="field_required" t-att-value="'name'" />
        </xpath>

        <xpath expr="//div[contains(@t-attf-class, 'div_street')]" position="attributes">
            <attribute name="t-if">
                mode[1] == 'billing' and website.use_billing_address_street or \
                mode[1] == 'shipping' and website.use_shipping_address_street or \
                partner_id == website_sale_order.partner_shipping_id.id == website_sale_order.partner_invoice_id.id and website.use_shipping_address_street
            </attribute>
        </xpath>

        <xpath expr="//div[contains(@t-attf-class, 'div_street2')]" position="attributes">
            <attribute name="t-if">
                mode[1] == 'billing' and website.use_billing_address_street and website.use_billing_address_street2 or \
                mode[1] == 'shipping' and website.use_shipping_address_street2 or \
                partner_id == website_sale_order.partner_shipping_id.id == website_sale_order.partner_invoice_id.id and website.use_shipping_address_street2
            </attribute>
        </xpath>

        <xpath expr="//div[contains(@t-attf-class, 'div_city')]" position="attributes">
            <attribute name="t-if">
                mode[1] == 'billing' and website.use_billing_address_city or \
                mode[1] == 'shipping' and website.use_shipping_address_city or \
                partner_id == website_sale_order.partner_shipping_id.id == website_sale_order.partner_invoice_id.id and website.use_shipping_address_city
            </attribute>
        </xpath>

        <xpath expr="//div[contains(@t-attf-class, 'div_state')]" position="attributes">
            <attribute name="t-if">
                mode[1] == 'billing' and website.use_billing_address_state or \
                mode[1] == 'shipping' and website.use_shipping_address_state or \
                partner_id == website_sale_order.partner_shipping_id.id == website_sale_order.partner_invoice_id.id and website.use_shipping_address_state
            </attribute>
        </xpath>

        <xpath expr="//t[contains(@t-if, '&lt; zip_city.index')]/div" position="attributes">
            <attribute name="t-if">
                mode[1] == 'billing' and website.use_billing_address_zip or \
                mode[1] == 'shipping' and website.use_shipping_address_zip or \
                partner_id == website_sale_order.partner_shipping_id.id == website_sale_order.partner_invoice_id.id and website.use_shipping_address_zip
            </attribute>
        </xpath>
        <xpath expr="//t[contains(@t-if, '&gt; zip_city.index')]/div" position="attributes">
            <attribute name="t-if">
                mode[1] == 'billing' and website.use_billing_address_zip or \
                mode[1] == 'shipping' and website.use_shipping_address_zip or \
                partner_id == website_sale_order.partner_shipping_id.id == website_sale_order.partner_invoice_id.id and website.use_shipping_address_zip
            </attribute>
        </xpath>

        <xpath expr="//div[contains(@t-attf-class, 'div_country')]" position="attributes">
            <attribute name="t-attf-class" separator=" " add="#{(mode[1] == 'billing' and not website.use_billing_address_country or mode[1] == 'shipping' and not website.use_shipping_address_country) and 'd-none' or ''} " />
        </xpath>

        <xpath expr="//div[contains(@t-attf-class, 'div_country')]/select/option" position="attributes">
            <attribute name="t-att-disabled">
                'True' \
                if mode[1] == 'billing' and website.default_billing_country_id and website.default_billing_country_only \
                or mode[1] == 'shipping' and website.default_shipping_country_id and website.default_shipping_country_only \
                else None
            </attribute>
        </xpath>
        <xpath expr="//div[contains(@t-attf-class, 'div_country')]/select/t/option" position="attributes">
            <attribute name="t-att-disabled">
                'True' \
                if mode[1] == 'billing' and website.default_billing_country_id and website.default_billing_country_only and c.id != website.default_billing_country_id.id \
                or mode[1] == 'shipping' and website.default_shipping_country_id and website.default_shipping_country_only and c.id != website.default_shipping_country_id.id \
                else None
            </attribute>
        </xpath>
        

        <xpath expr="//input[@name='field_required']" position="attributes">
            <attribute name="t-att-value">
                'phone,name' \
                if mode[1] == 'billing' and website.use_billing_address_phone and website.billing_address_phone_required \
                or mode[1] == 'shipping' and website.use_shipping_address_phone and website.shipping_address_phone_required \
                else 'name'
            </attribute>
        </xpath>

    </template>

</odoo>
